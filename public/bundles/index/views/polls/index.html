<span style="font-size: smaller; color: grey">Представляем вашему вниманию дизайн от Харона. Здорово, правда?</span>
<input type="hidden" id="pollId" value="{{pollId}}">
<div class="theme-dark">
    <h2>{{title}}</h2>
    <form action="" method="post">
        {{options}}
        <button type="submit">Подтвердить голос</button>
    </form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        let pollId = $('#pollId').val();
        setInterval(
        function() {
            $.get({
                url: '/poll/load_json',
                data: {poll_id: pollId},
                dataType: 'json',
                success: function (data) {
                    let votesSum = 0;
                    for (let option in data) {
                        let votesCount = data[option];
                        votesSum += parseInt(votesCount);
                    }

                    for (let option in data) {
                        let votesCount = data[option];
                        $('.votesCount_' + option).html(votesCount);
                        $('.votesPercent_' + option).html(Math.round(votesCount / votesSum * 10000) / 100);
                    }
                }
            })
        }, 5000);

        $('.pollOption').click(function () {
            $('.pollOption').removeClass('chosen');
            $(this).addClass('chosen');
        });
    });
</script>